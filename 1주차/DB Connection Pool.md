# DB Connection Pool

### __DB Connection Pool__ 이란?
- 데이터베이스와 연결된 커넥션을 미리 만들어서 Pool 속에 저장해 두고 있다가 필요할 때 커넥션 풀에서 쓰고 다시 풀에 반환하는 기법
- 웹에서는 DB 환경설정과 연결 관리 등을 따로 XML 파일이나 속성 파일을 사용해서 관리하고, 이렇게 설정된 정보를 이름을 사용해 획득하는 방법으로 수행한다.
- 웹 컨테이너가 실행되면 Connection 객체를 미리 Pool에 생성
- DB와 연결된 Connection을 미리 생성해 Pool 속에 저장해 두고 있다가 필요할 때 가져다 쓰고 반환
- 미리 생성해두기 때문에 DB 부하를 줄이고, 유동적으로 연결을 관리


  ![dbConnectionPool](/images/dbConnectionPool.png)

- 풀 속에 미리 생성되어 있는 커넥션을 가져다가 사용하고, 사용이 끝나면 커넥션을 풀에 반환한다.

<br>
### 커넥션 풀(DBCP) 사용 이유
ex ) 한 명의 접속자로 인한 DB 접속 - 게시판을 확인하고, 자신이 쓴 게시물을 수정하고, 새로운 게시물을 등록한다고 할 때.

	1. 데이터 취득
	2. 검색 후 데이터 취득
	3. 데이터 갱신
	4. 데이터 새등록

  한 명의 접속자로 인해 단 시간에 4번의 DB접속이 일어났다. 접속자가 1000명이라면...?
  즉, 커넥션 풀이란 이러한 여러번의 DB 접속의 발생 횟수를 줄이기 위해 미리 커넥션 객체를 생성하고,    
  해당 커넥션 객체를 관리할 수 있도록 해준다.    
  요약하자면, 커넥션 풀에 DB와 연결을 해 놓은 객체를 두고 필요할 때마다 커넥션 풀에서 빌려온다.

<br>
### 커넥션 풀(DBCP)의 특징
- 풀 속에 미리 커넥션이 생성되어 있기 때문에 커넥션을 생성하는 데 드는 연결 시간이 소비되지 않는다.
- 커넥션을 계속 재사용하기 때문에 생성되는 커넥션 수가 많지 않다.
- 커넥션을 생성하고 닫는 시간이 소모되지 않기 때문에 프로그램 실행 속도가 빨라지며, 한 번에 생성될 수 있는 커넥션 수를 제어하기 때문에 동시 접속자 수가 몰려도 프로그램이 쉽게 다운되지 않는다.

<br>
### 동시 접속자의 처리?
- 커넥션 풀에서 생성되어 있는 커넥션의 갯수는 한정적이다. 이 때, 동시 접속자가 많아진다면 ?

   누군가 접속하면 커넥션 풀에 남아있는 커넥션을 제공한다.
   남아있는 커넥션이 없을 경우, 해당 클라이언트는 대기 상태로 전환이 되고, 커넥션이 반환되면 대기하고 있는 순서대로 커넥션이 제공된다.
